<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- FullCalendar CSS -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css' rel='stylesheet' />

    <!-- FullCalendar JS -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>
    <style>
        #calendar {
            max-width: 900px;
            margin: 40px auto;
        }

        /* 이전/다음 버튼 배경색 변경 */
        .fc-prev-button,
        .fc-next-button {
            background-color: #333 !important;
            /* 원하는 색상으로 변경 */
            border: none;
            color: white;
            border-radius: 4px;
            padding: 6px 12px;
        }

        /* 마우스 오버 시 색상 */
        .fc-prev-button:hover,
        .fc-next-button:hover {
            background-color: #777 !important;
        }

        .custom-filter {
            height: 32px;
            /* FullCalendar 기본 버튼 높이에 맞춤 */
            background-color: #333;
            border: none;
            color: white;
            border-radius: 4px;
            padding: 4px 32px 4px 8px;
            appearance: none;
            /* 기본 화살표 제거 */
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%22240%22%20height%3D%22240%22%20viewBox%3D%220%200%20240%20240%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20d%3D%22M0%2030l120%20120L240%2030z%22%20fill%3D%22white%22/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            /* ← 여기서 커서 오른쪽 여백 조절 */
            background-size: 10px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id='calendar'></div>
    <script>
        function applyFilters(calendar) {
            const selectedCenter = document.getElementById('centerFilter').value;
            const selectedClass = document.getElementById('classFilter').value;

            const filtered = rawEvents.filter(event => {
                const matchesCenter =
                    selectedCenter === 'none' || event.extendedProps.center === selectedCenter;
                const matchesClass =
                    selectedClass === 'none' || event.title === selectedClass;

                return matchesCenter && matchesClass;
            });
            const coloredEvents = filtered.map(event => ({
                ...event,
                display: 'block',
                color: programColors[event.title] || '#cccccc',
                textColor: '#000'
            }));

            calendar.removeAllEvents();
            calendar.addEventSource(coloredEvents);
        }

        const programDescriptions = {
            '레벨테스트': '라이센스 취득을 위한 레벨테스트입니다.',
            '이퀄 세미나': '압력균형 이해<br/>F-TUBE 이해<br/>압력기관 통제<br/>프렌젤 지상실행<br/>제한수역 실행<br/><br/>이론 교육장에서 이론 수업 먼저 진행됩니다.',
            '세션교육': '최대 1:4 소규모 집중 교육으로 실력을 향상시켜 보세요.',
        };
        const programColors = {
            '응급처치 교육': '#ffb572',
            '머메이드': '#ffac7e',
            '이퀄 세미나': '#ff9980',
            '강사와 함께 펀다이빙': '#f08984',
            '마스터 교육': '#f2a7b6',
            '마스터 트레이닝': '#e4acd1',
            '세션교육': '#cdb9eb',
            '정기 트레이닝': '#a8bce5',
            '파라다이브': '#99c6e0',
            '해양투어': '#a5e0c1',
            '레벨테스트': '#bfe39d',
            '스페셜티': '#cedd90'
        };

        const rawEvents = [
            {
                title: '레벨테스트',
                start: '2025-04-02T10:00',
                end: '2025-04-02T12:00',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },
            {
                title: '레벨테스트',
                start: '2025-04-06T14:00',
                end: '2025-04-06T16:00',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },
            {
                title: '레벨테스트',
                start: '2025-04-08T19:30',
                end: '2025-04-08T21:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },
            {
                title: '레벨테스트',
                start: '2025-04-13T14:00',
                end: '2025-04-13T16:00',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },
            {
                title: '레벨테스트',
                start: '2025-04-15T12:00',
                end: '2025-04-15T14:00',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },
            {
                title: '레벨테스트',
                start: '2025-04-24T19:30',
                end: '2025-04-24T21:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20241120_80/1732085926541IcMn8_PNG/VID_20241103_164655_032.png?type=w1500',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/6253679/?'
                }
            },



            {
                title: '이퀄 세미나',
                start: '2025-04-10T19:00',
                end: '2025-04-10T21:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20231102_297/1698895108805wCigl_PNG/GOPR0731.png',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5661046/?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '이퀄 세미나',
                start: '2025-04-19T13:00',
                end: '2025-04-19T15:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20231102_297/1698895108805wCigl_PNG/GOPR0731.png',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5661046/?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '이퀄 세미나',
                start: '2025-04-22T17:00',
                end: '2025-04-22T21:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20231102_297/1698895108805wCigl_PNG/GOPR0731.png',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5661046/?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '이퀄 세미나',

                start: '2025-04-27T09:00',
                end: '2025-04-27T11:30',
                extendedProps: {
                    center: '일산',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20231102_297/1698895108805wCigl_PNG/GOPR0731.png',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5661046/?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },




            {
                title: '세션교육',
                start: '2025-04-03T19:00',
                end: '2025-04-03T21:30',
                extendedProps: {
                    center: '잠실',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20250330_231/17433045516359pHMv_JPEG/KakaoTalk_20210511_155613417_01_%281%29.jpg',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5281109?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '세션교육',
                start: '2025-04-08T19:00',
                end: '2025-04-08T21:30',
                extendedProps: {
                    center: '잠실',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20250330_231/17433045516359pHMv_JPEG/KakaoTalk_20210511_155613417_01_%281%29.jpg',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5281109?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '세션교육',
                start: '2025-04-17T19:00',
                end: '2025-04-17T21:30',
                extendedProps: {
                    center: '잠실',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20250330_231/17433045516359pHMv_JPEG/KakaoTalk_20210511_155613417_01_%281%29.jpg',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5281109?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
            {
                title: '세션교육',
                start: '2025-04-29T19:00',
                end: '2025-04-29T21:30',
                extendedProps: {
                    center: '잠실',
                    thumbnail: 'https://naverbooking-phinf.pstatic.net/20250330_231/17433045516359pHMv_JPEG/KakaoTalk_20210511_155613417_01_%281%29.jpg',
                    link: 'https://booking.naver.com/booking/12/bizes/281683/items/5281109?preview=1&startDateTime=2025-04-14T00%3A00%3A00%2B09%3A00'
                }
            },
        ];
        const events = rawEvents.map(event => ({
            ...event,
            display: 'block',
            color: programColors[event.title] || '#cccccc', // 기본 색도 fallback
            textColor: '#000', // 필요시
        }))


        document.addEventListener('DOMContentLoaded', function () {
            const calendarEl = document.getElementById('calendar');
            let calendar = new FullCalendar.Calendar(calendarEl, {
                eventTimeFormat: {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: false
                },
                initialView: 'dayGridMonth',
                events: events,
                headerToolbar: {
                    left: 'centerFilterDropdown classFilterDropdown',// 필요 시 여기에 필터 버튼 추가 예정
                    center: 'title',
                    right: 'prev,next'
                },
                customButtons: {
                    centerFilterDropdown: {
                        text: '지점 ▼',
                        click: () => { }
                    },
                    classFilterDropdown: {
                        text: '수업 ▼',
                        click: () => { }
                    }
                },
                titleFormat: function (date) {
                    const year = date.date.year;
                    const month = String(date.date.month + 1).padStart(2, '0'); // 0~11이니까 +1
                    return `${year}년 ${month}월`;
                },
                eventClick: function (info) {
                    const props = info.event.extendedProps;
                    const title = info.event.title;

                    const start = new Date(info.event.start);
                    const end = new Date(info.event.end);
                    const startTime = start.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
                    const endTime = end.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });

                    const description = programDescriptions[title] || '';

                /*썸네일이미지*/document.querySelector(".modal-thumbnail").src = props.thumbnail || "";
                /*지점명*/document.querySelector(".modal-center").innerText = info.event.extendedProps.center || '-';
                /*프로그램명*/document.querySelector(".modal-program").innerText = props.program || info.event.title;
                /*프로그램설명*/document.querySelector(".modal-description").innerHTML = description;
                /*시간표시*/document.querySelector(".modal-time").innerText = `${startTime} ~ ${endTime}`;
                /*예약링크*/document.querySelector(".modal-link").href = props.link || "#";
                /*모달열기*/document.getElementById("eventModal").style.display = "block";
                }
            });
            calendar.render();

            // 필터 드롭다운입
            const centerSelect = document.createElement('select');
            centerSelect.id = 'centerFilter';
            centerSelect.classList.add('custom-filter');
            centerSelect.innerHTML = `
                <option value="none">전체 지점</option>
                <option value="일산">일산</option>
                <option value="잠실">잠실</option>
                <option value="파라다이브">파라다이브</option>
                `;

            const classSelect = document.createElement('select');
            classSelect.id = 'classFilter';
            classSelect.classList.add('custom-filter');
            classSelect.innerHTML = `
                <option value="none">전체 수업</option>
                <option value="강사와 함께 펀다이빙">강사와 함께 펀다이빙</option>
                <option value="레벨테스트">레벨테스트</option>
                <option value="마스터 교육">마스터 교육</option>
                <option value="마스터 트레이닝">마스터 트레이닝</option>
                <option value="머메이드">머메이드</option>
                <option value="세미나">세미나</option>
                <option value="세션교육">세션교육</option>
                <option value="스페셜티">스페셜티</option>
                <option value="응급처치 교육">응급처치 교육</option>
                <option value="이론교육">이론교육</option>
                <option value="자유연습 및 펀다이빙">자유연습 및 펀다이빙</option>
                <option value="정기 트레이닝">정기 트레이닝</option>
                <option value="파라다이브">파라다이브</option>
                <option value="해양투어">해양 투어</option>
                `;

            const leftEl = calendarEl.querySelector('.fc-toolbar-chunk:first-child');
            leftEl.innerHTML = '';
            leftEl.appendChild(centerSelect);
            leftEl.appendChild(classSelect);

            // 필터 동작 연결
            centerSelect.addEventListener('change', () => applyFilters(calendar));
            classSelect.addEventListener('change', () => applyFilters(calendar));
        });

    </script>
    <!-- ✅ 모달 팝업 HTML 추가 (body에 넣어줘야 해!) -->
    <div id="eventModal"
        style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
background:white; border-radius:10px; padding:20px; width:500px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); z-index:9999; overflow: auto; position:fixed;">
        <button onclick="closeModal()"
            style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:20px; cursor:pointer;">
            &times;
        </button>
        <!-- 상단: 이미지 + 설명을 flex로 나눔 -->
        <div style="display:flex; height:300px;">
            <!-- 좌측 이미지 (50%) -->
            <div style="flex: 1; aspect-ratio: 1 /1 ; overflow:hidden; 
                display: flex; justify-content: center; align-items: center; 
                ">
                <img class="modal-thumbnail" src="" alt="썸네일 이미지"
                    style="max-width:100%; max-height:100%; object-fit: contain;">
                <!-- src="https://search.pstatic.net/common/?autoRotate=true&quality=95&type=w750&src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20200721_159%2F15953264531517Do2k_JPEG%2Flqi0OPV8gAVpbPK94U-8_E0u.jpg" -->
            </div>

            <!-- 우측 설명글 (50%) -->
            <div style="flex: 1; padding:15px; box-sizing:border-box;overflow:auto; 
            display: flex; flex-direction: column; justify-content: center; ">
                <h3 class="modal-center" style="margin:0;">지점명</h3>
                <h3 class="modal-program" style="margin:20px 0 0 0;">프로그램명</h3>
                <p class="modal-description" style="margin:8px 0 0 0; font-size:14px; color:#333;">프로그램 설명</p>
                <h3 style="margin:20px 0 0 0;">수업 시간</h3>
                <p class="modal-time" style="margin:8px 0 0 0; font-size:14px; color:#333;">시작시간 ~ 종료시간</p>
            </div>
        </div>

        <!-- 하단: 버튼 -->
        <div style="text-align:center; margin-top: 30px;">
            <a class="modal-link" href="#" target="_blank"
                style="display:inline-block; padding:10px 20px; background:#1ec800; color:white; border-radius:5px; text-decoration:none;">
                예약하기
            </a>
        </div>
    </div>

    <!-- 모달 닫기 동작 -->
    <script>
        function closeModal() {
            document.getElementById("eventModal").style.display = "none";
        }

        // ESC 키로 닫기
        document.addEventListener('keydown', function (e) {
            if (e.key === "Escape") {
                closeModal();
            }
        });

        function applyFilters(calendar) {
            const selectedCenter = document.getElementById('centerFilter').value;
            const selectedClass = document.getElementById('classFilter').value;

            const filtered = rawEvents.filter(event => {
                const matchesCenter =
                    selectedCenter === 'none' || event.extendedProps.center === selectedCenter;
                const matchesClass =
                    selectedClass === 'none' || event.title === selectedClass;

                return matchesCenter && matchesClass;
            });

            const coloredEvents = filtered.map(event => ({
                ...event,
                display: 'block',
                color: programColors[event.title] || '#cccccc',
                textColor: '#000'
            }));

            calendar.removeAllEvents();
            calendar.addEventSource(coloredEvents);
        }



    </script>
</body>

</html>